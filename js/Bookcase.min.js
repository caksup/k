function Bookcase(a, b) {
var c = this,
d = {
isSelf: "0",
isShowCategory: "0",
isShowContact: "0",
isShowLogo: "0",
isShowSearch: "0",
isShowShare: "0",
isShowSkin: "0",
isFolderList: "0",
logoLink: "anyflip.com",
logoName: "",
skin: "red",
caseWidth: "100",
caseHeight: "100",
csaeBG: "",
bMode: "1"
},
e = {
1: {
width: 120,
height: 110,
rowH: 136,
img: ["//static.anyflip.com/web/bookcase/img/gold-1.png", "//static.anyflip.com/web/bookcase/img/green-1.png", "//static.anyflip.com/web/bookcase/img/red-1.png", "//static.anyflip.com/web/bookcase/img/silver-1.png", "//static.anyflip.com/web/bookcase/img/yellow-1.png"]
},
2: {
width: 130,
height: 140,
rowH: 172,
img: ["//static.anyflip.com/web/bookcase/img/gold-2.jpg", "//static.anyflip.com/web/bookcase/img/green-2.jpg", "//static.anyflip.com/web/bookcase/img/red-2.jpg", "//static.anyflip.com/web/bookcase/img/silver-2.jpg", "//static.anyflip.com/web/bookcase/img/yellow-2.jpg"]
},
3: {
width: 152,
height: 166,
rowH: 208,
img: ["//static.anyflip.com/web/bookcase/img/gold-3.jpg", "//static.anyflip.com/web/bookcase/img/green-3.jpg", "//static.anyflip.com/web/bookcase/img/red-3.jpg", "//static.anyflip.com/web/bookcase/img/silver-3.jpg", "//static.anyflip.com/web/bookcase/img/yellow-3.jpg"]
}
},
f = {
1: ["//static.anyflip.com/web/bookcase/img/gold-1.png", "//static.anyflip.com/web/bookcase/img/green-1.png", "//static.anyflip.com/web/bookcase/img/red-1.png", "//static.anyflip.com/web/bookcase/img/silver-1.png", "//static.anyflip.com/web/bookcase/img/yellow-1.png"],
2: ["//static.anyflip.com/web/bookcase/img/gold-2.jpg", "//static.anyflip.com/web/bookcase/img/green-2.jpg", "//static.anyflip.com/web/bookcase/img/red-2.jpg", "//static.anyflip.com/web/bookcase/img/silver-2.jpg", "//static.anyflip.com/web/bookcase/img/yellow-2.jpg"],
3: ["//static.anyflip.com/web/bookcase/img/gold-3.jpg", "//static.anyflip.com/web/bookcase/img/green-3.jpg", "//static.anyflip.com/web/bookcase/img/red-3.jpg", "//static.anyflip.com/web/bookcase/img/silver-3.jpg", "//static.anyflip.com/web/bookcase/img/yellow-3.jpg"],
4: ["//static.anyflip.com/web/bookcase/img/gold-4.jpg", "//static.anyflip.com/web/bookcase/img/green-4.jpg", "//static.anyflip.com/web/bookcase/img/red-4.jpg", "//static.anyflip.com/web/bookcase/img/silver-4.jpg", "//static.anyflip.com/web/bookcase/img/yellow-4.jpg"]
},
g = ["//static.anyflip.com/web/bookcase/img/gold-nav.png", "//static.anyflip.com/web/bookcase/img/gold-footer.png", "//static.anyflip.com/web/bookcase/img/green-nav.png", "//static.anyflip.com/web/bookcase/img/green-footer.png", "//static.anyflip.com/web/bookcase/img/red-nav.png", "//static.anyflip.com/web/bookcase/img/red-footer.png", "//static.anyflip.com/web/bookcase/img/silver-nav.png", "//static.anyflip.com/web/bookcase/img/silver-footer.png", "//static.anyflip.com/web/bookcase/img/yellow-nav.png", "//static.anyflip.com/web/bookcase/img/yellow-footer.png"];
this.options = $.extend({}, d, b), this.isFolderList = "1" == this.options.isFolderList, this.folderBooks = {}, this.isShowFolder = this.isFolderList, this.currentFolderId = "-1", this.options.isShowCategory = this.isFolderList ? "0" : this.options.isShowCategory;
var h = this.options.bMode,
i = e[h];
this.bWidth = i.width, this.bHeight = i.height, this.bookWidth = this.bWidth + 30, this.offsetX = 20, this.rowHeight = i.rowH, this.firstOther = "1" == this.options.isShowCategory ? 36 : 0, this.cache = {}, this.bookObj = {}, this.originalData = b.bookData, this.newData = b.bookData, this.isShowThumb = !0, this.bookNum = this.newData.length, this.isLocked = "1" === this.options.pass || "0" === this.options.status, c.categoryid = "-1", this.$container = $(a) || $("body"), $("body").removeClass().addClass("" == this.options.skin ? "red" : this.options.skin);
var j = $("<div class='bookcase-panel'></div>"),
k = $("<div class='bookcase-nav'></div>"),
l = $("<div class='bookcase-content'></div>"),
m = $("<div class='case-panel'></div>").addClass("mode-" + h),
n = ($("<div class='case-top'></div>"), $("<div class='case-background'></div>")),
o = $("<div class='case-content user-select-none'></div>"),
p = $("<div class='case-message vertical hide'></div>"),
q = $("<div class='vertical-content'></div>"),
r = $("<div class='bookcase-footer user-select-none'></div>"),
s = parseInt(this.options.caseWidth),
t = parseInt(this.options.caseHeight);
s = (isNaN(s) ? 100 : Math.min(s, 100)) + "%", t = (isNaN(t) ? 100 : Math.min(t, 100)) + "%", j.width(s).height(t), this.$navTop = k, this.$footer = r, this.$content = l, this.$caseBG = n, this.$caseContent = o, this.$casePanel = m, this.$caseMess = p, this.$messPanel = q, j.append(k).append(l.append(m.append(n).append(o))).append(r).append(p.append(q)).appendTo(this.$container), "1" === this.options.pass && "1" === this.options.status ? this.showMessage(this.hasEncrypt()) : "0" === this.options.status && this.showMessage(hf_utils.getLangVal("bcInvisible"));
var u = null;
$(window).on("resize", function() {
u && clearTimeout(u), u = setTimeout(function() {
c.resize()
}, 50)
}), this.createNav(), this.createFooter(), this.resize(), this.bindEvents(), setTimeout(function() {
hf_utils.loadImg(g.concat(f[c.options.bMode]))
}, 1e3), "1" == this.options.isShowCategory && (this.createCategory(), setTimeout(function() {
hf_utils.loadImg(f[parseInt(c.options.bMode) + 1])
}, 1e3)), this.showFolderHideBtns(this.isShowFolder, !0), window.aa = this
}

function LightBox(a, b, c) {
var d = $("<div class='light-box-bg'></div>"),
e = $("<div class='light-box-out'></div>"),
f = $("<div class='light-box sh5-table'></div>").addClass(c),
g = $("<div class='sh5-table-centered'></div>"),
h = $("<div class='light-box-content'></div>").width(b),
i = $("<div class='light-box-panel'></div>"),
j = $("<div class='light-box-title'>" + a + "</div>"),
k = $("<div class='light-box-cancel-btn' title='" + hf_utils.getLangVal("lbCnacelBtn") + "'>x</div>");
e.append(d).append(f.append(g.append(h.append(j.append(k)).append(i)))), this.$outBox = e, this.$box = f, this.$panel = i, this.$cancelBtn = k, this.$bg = d, this.$doc = $(document), this.$content = h, this.width = b, this.stopResize = !1, $(window).on("resize", this.resize.bind(this, 0)), hf_utils.isLteIE8() ? k.add(d).on("click", this.cancel.bind(this)) : new Hammer(k[0]).on("tap", this.cancel.bind(this))
}

function SharePanel(a) {
var b = a.link,
c = new LightBox(hf_utils.getLangVal("spTitle"), 485),
d = $("<div class='row text-center'></div>"),
e = $("<div class='share-qr-container'></div>"),
f = $("<div class='row'></div>"),
g = $("<label>" + hf_utils.getLangVal("spLabel") + "</label>"),
h = $("<input class='share-url-input' type='text' value='" + b + "'></input>");
$shareGroup = $("<div class='row overflow-hid'></div>"), $shareLabel = $("<label class='left'>" + hf_utils.getLangVal("spInput") + "</label>"), $shareButs = $("<span class='left share-social-buts'></span>"), $shareQQ = $("<a class='facebook' title='' href='https://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(b) + "' target='_blank'></a>"), $shareSina = $("<a class='twitter' title='' href='https://www.twitter.com/share?url=" + encodeURIComponent(b) + "' target='_blank'></a>"), $shareT = $("<a class='google' title='' href='https://plus.google.com/share?url=" + encodeURIComponent(b) + "' target='_blank'></a>"), $shareRenren = $("<a class='linkedin' title='' href='https://www.linkedin.com/cws/share?url=" + encodeURIComponent(b) + "' target='_blank'></a>"), c.getPanel().append(d.append(e)).append(f.append(g).append(h)).append($shareGroup.append($shareLabel).append($shareButs.append($shareQQ).append($shareSina).append($shareT).append($shareRenren))), e.qrcode({
width: 110,
height: 110,
text: b
}), a.isSelf, c.launch(!0), hf_utils.isLteIE8() ? h.on("click", function() {
h[0].select()
}) : new Hammer(h[0]).on("tap", function() {
h[0].select()
})
}

function SmartSelect(a) {
var b = this,
c = {
className: "",
container: null,
data: [],
changeCallback: function() {}
};
this.options = $.extend({}, c, a);
var d = $("<div class='smart-select-arrow'><div class='smart-arrow-up'></div><div class='smart-arrow-down'></div></div>"),
e = $("<ul class='smart-select-options hide'></ul>").addClass(this.options.className),
f = $("<div class='smart-select-value'></div>"),
g = this.options.data,
h = $(this.options.container);
this.showing = !1;
for(var i = 0; i < g.length; i++) e.append("<li data-value=" + g[i].value + " data-label='" + g[i].label + "'>" + g[i].label + "</li>"), g[i].isDefault && f.text(g[i].label).data("value", g[i].value);
this.$val = f, this.$opt = e, this.$container = h, h.append(d).append(f).append(e), f.css({
marginLeft: h.css("paddingLeft"),
lineHeight: h.height() + parseInt(h.css("paddingTop"), 10) + parseInt(h.css("paddingBottom"), 10) + "px"
}), e.find("li").css({
paddingLeft: h.css("paddingLeft")
}), hf_utils.isLteIE8() ? (e.on("click", this.choose.bind(this)), h.on("click", this.toggleOption.bind(this)), $("body").on("click", function(a) {
$.contains(h[0], a.target) || h[0] == a.target || b.hideOptions()
})) : (new Hammer(e[0]).on("tap", this.choose.bind(this)), new Hammer(h[0]).on("tap", this.toggleOption.bind(this)), new Hammer($("body")[0]).on("tap", function(a) {
$.contains(h[0], a.target) || h[0] == a.target || b.hideOptions()
}))
}

function DemoPanel(a, b, c, d) {
hf_utils.isMobile() && (b.indexOf("index.html") >= 0 ? b = b.replace(/index.html/, "") + "?maxwidthtosmallmode=0&maxheighttosmallmode=0" : b += "?maxwidthtosmallmode=0&maxheighttosmallmode=0");
var e = $("<iframe class='bomb-box-read af-loading-bg' allowfullscreen frameborder='0'></iframe>"),
f = e[0],
a = hf_utils.isMobile() ? "" : a + "&nbsp;&nbsp;<a target='_blank' href='" + b + "'>" + hf_utils.getLangVal("dpTitle") + "</a>",
g = hf_utils.isMobile() ? "iframe" : "iframe on-pc",
h = new LightBox(a, "100%", g),
i = h.getPanel(),
j = h.getBox(),
k = h.getCancelBtn();
if(e.on("touchmove", function(a) {
a.preventDefault()
}), hf_utils.isMobile() && j.append(k), i.addClass("").append(e), h.setStopResize(!0), h.launch(), e.attr("src", b), hf_utils.isMobile()) {
new ToolTip({
container: i,
content: k,
position: "left",
text: hf_utils.getLangVal("dpToolTip"),
removeTime: 3e3
}).getPanel().fadeIn(1e3);
var l = new Hammer(k[0]),
m = k[0].offsetTop,
n = k[0].offsetLeft;
l.get("pan").set({
direction: Hammer.DIRECTION_ALL
}), l.on("panstart", function(a) {
m = k[0].offsetTop, n = k[0].offsetLeft
}), l.on("panmove", function(a) {
k.css({
left: n + a.deltaX,
top: m + a.deltaY
})
}), l.on("panend", function(a) {
m = k[0].offsetTop
})
}
f.onload = f.onreadystatechange = function() {
this.readyState && "complete" != this.readyState || e.removeClass("af-loading-bg")
}
}

function BookDetailPanel(a, b, c) {
this.boxWidth = 485, a.css("top", 0);
var d = new LightBox(hf_utils.getLangVal("bdpTitle"), this.boxWidth),
e = $("<div class='book-detail-content'></div>").css({
minHeight: a.outerHeight() + 15
}),
f = $("<div class='book-detail-book'></div>").css({
width: Math.max(a.outerWidth(), 70),
height: a.outerHeight()
}),
g = $("<img class='book-detail-shelf' src='img/shelf.png'>"),
h = ($("<div class='book-detail-info'></div>"), $("<div class='book-detail-title'>" + hf_utils.encodeHTML(b.title) + "</div>")),
i = $("<div class='book-detail-page'>" + hf_utils.getLangVal("bdpPage") + ": " + b.pages + "</div>"),
j = $("<div class='book-detail-desc' title='" + hf_utils.br2nl(hf_utils.encodeHTML(b.description)) + "'>" + hf_utils.encodeHTML(b.description) + "</div>"),
k = $("<div class='button button-blue button-rounded button-block button-large'>" + hf_utils.getLangVal("bdpView") + "</div>"),
l = $("<p class='book-detail-time'>" + hf_utils.getLangVal("bdpNewTime") + " " + hf_utils.parseDate(b.newTime).toDateString() + "</p>");
a.css({
left: -2
}), hf_utils.isLteIE8() ? (a.on("click", function() {
d.cancel(), new DemoPanel(b.title, c)
}), k.on("click", function() {
d.cancel(), new DemoPanel(b.title, c)
})) : (new Hammer(a[0]).on("tap", function() {
d.cancel(), new DemoPanel(b.title, c)
}), new Hammer(k[0]).on("tap", function() {
d.cancel(), new DemoPanel(b.title, c)
})), this.$detail = e, d.getPanel().append(e.append(f.append(g).append(a)).append(h).append(i).append(j).append(k)).append(l), d.launch()
}

function UserDetailPanel(a) {
var b = new LightBox(hf_utils.getLangVal("udpTitle"), 485),
c = $("<div class='user-info-content float-fix'></div>");
$logo = $("<div class='user-logo-constent'></div>"), $img = $("<img src='" + a.accountLogo + "'>"), $info = $("<div class='left user-info-group'></div>"), $name = $("<p>" + a.name + "</p>"), $about = $("<p>" + a.about + "</p>"), $web = $("<p><a target='_blank' href='" + (a.website.match("https?://") ? a.website : "//" + a.website) + "'>" + a.website + "</a></p>").addClass("" == a.website ? "hide" : "");
var d = $("<div></div>"),
e = $("<input class='user-info-input' type='text' placeholder='Your Full Name' value=''></input>"),
f = $("<input class='user-info-input' type='email' placeholder='Your E-mail Address' value=''></input>"),
g = $("<input class='user-info-input' type='text' placeholder='Subject' value=''></input>"),
h = $("<textarea class='user-info-textarea' rows='4' placeholder='Message'></textarea>"),
i = $("<div class='row text-center'></div>"),
j = $("<div class='button button-gray button-rounded button-block button-large'>Send</div>"),
k = $("<div class='alert-success user-info-mail-status-container hide'></div>"),
l = $("<p>Your message has been sent successfully!</p>"),
m = $("<div class='row'></div>"),
n = $("<div class='button button-blue button-rounded marginX'>Send Another Email</div>"),
o = $("<div class='button button-gray button-rounded marginX'>Close</div>"),
p = $("<div class='alert-info user-info-mail-status-container hide'></div>"),
q = $("<p>Sending...</p>"),
r = $("<div class='alert-error user-info-mail-status-container hide'></div>"),
s = $("<p>Oops! Due to an unknown error, your message was not send, please resend it or try again later.</p>"),
t = $("<div class='row'></div>"),
u = $("<div class='button button-blue button-rounded marginX'>Re-Send</div>"),
v = $("<div class='button button-gray button-rounded marginX'>Close</div>");
this.opt = a, this.lightBox = b, this.$errorGroup = r, this.$sendingGroup = p, self.$successGroup = k, this.$nameInput = e, this.$emailInput = f, this.$subjectInput = g, this.$messageArea = h, this.$contactForm = d, b.getPanel().append(c.append($logo.append("<span class='ff-vertical-align'></span>").append($img)).append($info.append($name).append($about).append($web))).append(d.append(e).append(f).append(g).append(h).append(i.append(j))).append(p.append(q)).append(k.append(l).append(m.append(n).append(o))).append(r.append(s).append(t.append(u).append(v))), hf_utils.isLteIE8() ? (j.on("click", this.send.bind(this)), n.on("click", this.sendAnother.bind(this)), o.on("click", this.close.bind(this)), u.on("click", this.reSend.bind(this)), v.on("click", this.close.bind(this))) : (new Hammer(j[0]).on("tap", this.send.bind(this)), new Hammer(n[0]).on("tap", this.sendAnother.bind(this)), new Hammer(o[0]).on("tap", this.close.bind(this)), new Hammer(u[0]).on("tap", this.reSend.bind(this)), new Hammer(v[0]).on("tap", this.close.bind(this))), b.launch()
}

function BookDownload(a) {
var b = {
len: 5,
downObj: {
pdf: !0,
zip: !0,
exe: !0,
exe2: !0,
mac: !0
}
};
a = $.extend({}, b, a);
var c = a.len,
d = a.downObj,
e = a.bookId,
f = $("<div class='book-download-panel'></div>"),
g = $("<ul class='book-download-content'></ul>"),
h = $("<li class='book-download-item'></li>").addClass(d.pdf ? "width-" + c : "af-hide"),
i = $("<div class='book-download-img'><img src='../img/pdf.png' /></div>"),
j = $("<p class='book-download-text'>" + hf_utils.getLangVal("bdPDFText") + "</p>"),
k = $("<div class='book-download-btn button-pure button-pure-red'>" + hf_utils.getLangVal("bdPDFBtn") + "</div>"),
l = $("<li class='book-download-item'></li>").addClass(d.zip ? "width-" + c : "af-hide"),
m = $("<div class='book-download-img'><img src='../img/zip.png' /></div>"),
n = $("<p class='book-download-text'>" + hf_utils.getLangVal("bdZIPText") + "</p>"),
o = $("<div class='book-download-btn button-pure button-pure-orange'>" + hf_utils.getLangVal("bdZIPBtn") + "</div>"),
p = $("<li class='book-download-item'></li>").addClass(d.exe ? "width-" + c : "af-hide"),
q = $("<div class='book-download-img'><img src='../img/exe.png' /></div>"),
r = $("<p class='book-download-text'>" + hf_utils.getLangVal("bdEXEText1") + "</p>"),
s = $("<div class='book-download-btn button-pure button-pure-blue'>" + hf_utils.getLangVal("bdEXEBtn1") + "</div>"),
t = $("<li class='book-download-item'></li>").addClass(d.exe2 ? "width-" + c : "af-hide"),
u = $("<div class='book-download-img'><img src='../img/exe.png' /></div>"),
v = $("<p class='book-download-text'>" + hf_utils.getLangVal("bdEXEText2") + "</p>"),
w = $("<div class='book-download-btn button-pure button-pure-sky-blue'>" + hf_utils.getLangVal("bdEXEBtn2") + "</div>"),
x = $("<li class='book-download-item'></li>").addClass(d.mac ? "width-" + c : "af-hide"),
y = $("<div class='book-download-img'><img src='../img/mac.png' /></div>"),
z = $("<p class='book-download-text'>" + hf_utils.getLangVal("bdMACText") + "</p>"),
A = $("<div class='book-download-btn button-pure button-pure-green'>" + hf_utils.getLangVal("bdMACBtn") + "</div>");
h.append(i).append(j).append(k), l.append(m).append(n).append(o), p.append(q).append(r).append(s), t.append(u).append(v).append(w), x.append(y).append(z).append(A), d.pdf && g.append(h), d.zip && g.append(l), d.exe && g.append(p), d.exe2 && g.append(t), d.mac && g.append(x), k.on("click", function() {
hf_utils.downPDF(e)
}), o.on("click", function() {
hf_utils.downZIP($(this), e)
}), s.on("click", function() {
hf_utils.downEXE1($(this), e)
}), w.on("click", function() {
hf_utils.downEXE2($(this), e)
}), A.on("click", function() {
hf_utils.downMAC($(this), e)
});
var B = new LightBox(hf_utils.getLangVal("bdTitle"), 150 * c, "down");
B.getPanel().append(f.append(g)), B.launch()
}

function ToolTip(a) {
var b = this,
c = {
container: $("body"),
content: null,
text: "",
otherTop: 8,
otherLeft: 8,
isBig: !0,
position: "top",
removeTime: 1e4
};
this.options = $.extend({}, c, a), this.options.container.append(this.create()), this.setPosition();
var d = parseInt(this.options.removeTime);
d >= 0 && setTimeout(function() {
b.$panel.fadeOut(function() {
b.$panel.remove()
})
}, d)
}
var hf_utils = {
requestDomain: function() {
return fh5.website.replace(/^https?:/, location.protocol)
},
encodeHTML: function(a) {
return void 0 !== a && null != a || (a = ""), a.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\\/g, "&#92;").replace(/"/g, "&quot;").replace(/'/g, "&#39;").replace(/\n/g, "<br>")
},
isPC: function() {
for(var a = navigator.userAgent, b = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod", "Nokia", "Symbian", "Phone", "Linux armv71", "MAUI", "UNTRUSTED/1.0", "Windows CE", "BlackBerry", "IEMobile"), c = !0, d = 0; d < b.length; d++)
if(a.indexOf(b[d]) > 0) {
c = !1;
break
} return c
},
isMobile: function() {
for(var a = navigator.platform, b = new Array("iPhone", "iPod", "iPad", "android", "Nokia", "SymbianOS", "Symbian", "Windows Phone", "Phone", "Linux armv71", "MAUI", "UNTRUSTED/1.0", "Windows CE", "BlackBerry", "IEMobile"), c = !1, d = 0; d < b.length; d++) a.match(b[d]) && (c = !0); - 1 != navigator.platform.indexOf("iPad") && (c = !0);
var e = navigator.appVersion;
return e.match(/linux/i) && (e.match(/mobile/i) || e.match(/X11/i)) && (c = !0), c
},
isLteIE8: function() {
return -1 !== navigator.userAgent.toLocaleLowerCase().indexOf("msie") && !+[1]
},
bindEvent: function(a, b) {
this.isLteIE8() ? a.on("click", function() {
b()
}) : new Hammer(a[0]).on("tap", function() {
b()
})
},
addPlaceHolder: function(a, b) {
a.val(b), a.on("focus", function() {
a.val().trim() === b && a.val("")
}), a.on("blur", function() {
"" === a.val().trim() && a.val(b)
})
},
parseDate: function(a, b) {
var c = a.split(" "),
d = c[0].split("-"),
e = c[1].split(":"),
f = new Date(d[0], d[1] - 1, d[2], e[0], e[1], e[2]);
return b && (f = new Date(f.getTime() + 144e5 - 60 * f.getTimezoneOffset() * 1e3).toLocaleString()), f
},
formatDate: function(a, b) {
var c = {
"M+": a.getMonth() + 1,
"d+": a.getDate(),
"h+": a.getHours(),
"m+": a.getMinutes(),
"s+": a.getSeconds(),
"q+": Math.floor((a.getMonth() + 3) / 3),
S: a.getMilliseconds()
};
/(y+)/.test(b) && (b = b.replace(RegExp.$1, (a.getFullYear() + "").substr(4 - RegExp.$1.length)));
for(var d in c) new RegExp("(" + d + ")").test(b) && (b = b.replace(RegExp.$1, 1 == RegExp.$1.length ? c[d] : ("00" + c[d]).substr(("" + c[d]).length)));
return b
},
nl2br: function(a) {
return a.replace(/\n/g, "<br>")
},
br2nl: function(a) {
return a.replace(/<.?br.?>/g, "\n")
},
loadImg: function(a) {
for(var b = 0; b < a.length; b++) {
(new Image).src = a[b]
}
},
getLabelFilePath: function(a) {
var b = "";
switch(a) {
case "1":
b = "label-new.png";
break;
case "2":
b = "label-hot.png";
break;
case "3":
b = "label-featured.png"
}
return "//anyflip.com/bookcase/img/" + b
},
getBookUrl: function(a, b, c, d, e, f, g, h, i, j, k, l) {
a = a.replace(/^http:/, location.protocol), j.attr("src", a + "1.webp"), l && l(h, i, j, k, a)
},
validateForm: function(a) {
var b = !1;
return a.find("input, textarea").each(function(a, c) {
var d = $(c),
e = d.val().trim();
"" === e || "email" === d.attr("type") && -1 === e.lastIndexOf("@") ? (d.addClass("invalid"), b = !0) : d.removeClass("invalid")
}), !b
},
addSpin: function(a) {
var b, c = a.css("position");
"absolute" !== c && "relative" !== c && "fixed" !== c && a.css("position", "relative"), b = $("<div class='af-spin-loading'></div>").appendTo(a), a.ccSpin = b
},
removeSpin: function(a) {
var b = a.ccSpin;
b && b.length > 0 && b.remove()
},
downPDF: function(a) {
window.open(this.requestDomain() + "/download/download-pdf-file.php?bookid=" + a, "_self")
},
downZIP: function(a, b) {
if(!a.hasClass("disabled")) {
var c = this,
d = this.requestDomain();
$.ajax({
url: d + "/download/create-book-zip-online.php",
type: "get",
dataType: "jsonp",
data: {
bookid: b
},
beforeSend: function() {
a.addClass("disabled"), c.addSpin(a)
},
success: function(e) {
switch(a.removeClass("disabled"), c.removeSpin(a), e.status) {
case "1":
window.open(d + "/download/download-zip-file.php?bookid=" + b, "_self");
break;
case "2":
alert(c.getLangVal("bdUseOut"));
break;
case "3":
alert(c.getLangVal("bdFreeText"));
break;
default:
alert(c.getLangVal("bdPackError"))
}
},
error: function() {
a.removeClass("disabled"), c.removeSpin(a), alert(c.getLangVal("bdPackError"))
}
})
}
},
downEXE1: function(a, b) {
if(!a.hasClass("disabled")) {
var c = this,
d = this.requestDomain();
$.ajax({
url: d + "/download/create-book-exe-zip-online.php",
type: "get",
dataType: "jsonp",
data: {
bookid: b
},
beforeSend: function() {
a.addClass("disabled"), c.addSpin(a)
},
success: function(e) {
switch(a.removeClass("disabled"), c.removeSpin(a), e.status) {
case "1":
window.open(d + "/download/download-exe-zip-file.php?bookid=" + b, "_self");
break;
case "2":
alert(c.getLangVal("bdUseOut"));
break;
case "3":
alert(c.getLangVal("bdFreeText"));
break;
default:
alert(c.getLangVal("bdPackError"))
}
},
error: function() {
a.removeClass("disabled"), c.removeSpin(a), alert(c.getLangVal("bdPackError"))
}
})
}
},
downEXE2: function(a, b) {
if(!a.hasClass("disabled")) {
var c = this,
d = this.requestDomain();
$.ajax({
url: d + "/download/create-exe-online.php",
type: "get",
dataType: "jsonp",
data: {
bookid: b
},
beforeSend: function() {
a.addClass("disabled"), c.addSpin(a)
},
success: function(e) {
switch(a.removeClass("disabled"), c.removeSpin(a), e.status) {
case "1":
window.open(d + "/download/download-exe-file.php?bookid=" + b, "_self");
break;
case "2":
alert(c.getLangVal("bdUseOut"));
break;
case "3":
alert(c.getLangVal("bdFreeText"));
break;
default:
alert(c.getLangVal("bdPackError"))
}
},
error: function() {
a.removeClass("disabled"), c.removeSpin(a), alert(c.getLangVal("bdPackError"))
}
})
}
},
downMAC: function(a, b) {
if(!a.hasClass("disabled")) {
var c = this,
d = this.requestDomain();
$.ajax({
url: d + "/download/create-macapp-zip-online.php",
type: "get",
dataType: "jsonp",
data: {
bookid: b
},
beforeSend: function() {
a.addClass("disabled"), c.addSpin(a)
},
success: function(e) {
switch(a.removeClass("disabled"), c.removeSpin(a), e.status) {
case "1":
window.open(d + "/download/download-macapp-zip-file.php?bookid=" + b, "_self");
break;
case "2":
alert(c.getLangVal("bdUseOut"));
break;
case "3":
alert(c.getLangVal("bdFreeText"));
break;
default:
alert(c.getLangVal("bdPackError"))
}
},
error: function() {
a.removeClass("disabled"), c.removeSpin(a), alert(c.getLangVal("bdPackError"))
}
})
}
},
getLangVal: function(a, b) {
var c = {
language: "Chinese",
lbCnacelBtn: "å…³é—­",
spTitle: "Share",
spLabel: "Share link",
spInput: "Share via",
dpTitle: "Open in new window",
dpToolTip: "Klik disini untuk menutup.",
bdpTitle: "Detail Buku",
bdpPage: "Jumlah Halaman",
bdpNewTime: "Publikasi",
bdpView: "Baca",
udpTitle: "Contact us",
bdTitle: "é€‰æ‹©ä¸‹è½½ç‰ˆæœ¬",
bdPDFBtn: "ä¸‹è½½PDF",
bdPDFText: "PDFä¸‹è½½",
bdZIPBtn: "ä¸‹è½½ZIP",
bdZIPText: "ZIPä¸‹è½½",
bdEXEBtn1: "ä¸‹è½½EXE",
bdEXEText1: "é˜²æ€æ¯’è½¯ä»¶è¯¯æŠ¥EXEåŒ…",
bdEXEBtn2: "ä¸‹è½½EXE",
bdEXEText2: "ç‹¬ç«‹EXEæ–‡ä»¶",
bdMACBtn: "ä¸‹è½½MAC",
bdMACText: "MACä¸‹è½½",
bdFreeText: "è¯·å‡çº§åˆ°æ”¶è´¹ç‰ˆã€‚",
bdPackError: "æ‰“åŒ…å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚",
bdUseOut: "è¿™ä¸ªæœˆæ‚¨çš„ä¸‹è½½æ¬¡æ•°å·²ç»ç”¨å®Œã€‚",
bcInvisible: "The bookcase owner has disabled this bookcase.",
bcAllBooks: "All",
bcSearchText: "Search",
bcNewUpload: "Newest",
bcOldUpload: "Oldest",
bcSearchResult: "No result. ",
bcSearchBack: "Back",
bcDownText: "ä¸‹è½½",
bcBookUnit: "book",
bcBookUnits: "books",
bcEncryptText: "This bookcase is encrypted.",
bcEncryptInput: "Type your password...",
bcEncryptBtn: "Enter",
bcEncryptRefer: "Enter...",
bcEncryptHint: "* Place enter password",
bcEncryptError: "* Incorrect password",
bcEncryptError2: "* Incorrect password"
};
return $.extend({}, c)[a] || b || ""
}
};
Bookcase.prototype = {
bindEvents: function() {
var a = this,
b = a.options,
c = b.openType;
if(hf_utils.isLteIE8() ? this.$content.on("click", ".book-wrapper", function() {
var d = $(this).attr("data-index"),
e = a.bookObj[d],
f = "" == b.domain || 0 == window.location.href.indexOf(b.baseUrl) ? e.url + "index.html" : "//" + b.domain + "/books/" + e.bLink + "/";
switch("" == b.domain || window.location.href.indexOf(b.baseUrl.replace(/^https?:/, "")) >= 0 ? (f = e.url + "index.html", f = f.replace(/^http:/, location.protocol)) : f = "http://" + b.domain + "/books/" + e.bLink + "/", c) {
case "1":
new DemoPanel(e.title, f);
break;
case "2":
window.open(f, "_blank");
break;
default:
new BookDetailPanel($(this).clone(), e, f)
}
}) : new Hammer(this.$content[0]).on("tap", function(d) {
var e = $(d.target),
f = e.parents(".book-wrapper");
if(!e.hasClass("book-down") && (e.hasClass("book-wrapper") || f.length > 0)) {
e = f.length > 0 ? f : e;
var g = e.attr("data-index"),
h = a.bookObj[g],
i = "" == b.domain || 0 == window.location.href.indexOf(b.baseUrl.replace(/^https?:/, "")) ? h.url + "index.html" : "//" + b.domain + "/books/" + h.bLink + "/";
switch("" == b.domain || window.location.href.indexOf(b.baseUrl.replace(/^https?:/, "")) >= 0 ? (i = h.url + "index.html", i = i.replace(/^http:/, location.protocol)) : i = "http://" + b.domain + "/books/" + h.bLink + "/", c) {
case "1":
new DemoPanel(h.title, i);
break;
case "2":
window.open(i, "_blank");
break;
default:
new BookDetailPanel(e.clone(), h, i)
}
}
}), hf_utils.isMobile()) this.$content.addClass("phone"), this.$content.on("scroll", function(b) {
var c = a.$content.scrollTop();
c = c < 0 ? 0 : c, a.setNumInput(c)
});
else {
if(hf_utils.isLteIE8()) this.$content.on("mousedown.IE78", function(b) {
var c = b || event,
d = c.clientY - a.$casePanel.position().top;
b.stopPropagation(), 1 == b.which && ($(document).on("mousemove.IE78", function(b) {
b.preventDefault(), b.stopPropagation(), c = b || event;
var e = c.clientY - d;
a.$casePanel.outerHeight(), a.$content.outerHeight();
a.swipeTo(e, !1, !0)
}), $(document).on("mouseup.IE78", function(a) {
var b = a || event;
b.preventDefault(), b.stopPropagation(), $(document).off("mousemove.IE78"), $(document).off("mouseup.IE78")
}))
});
else {
var d = new Hammer(this.$casePanel[0]),
e = a.$casePanel[0].offsetTop;
d.get("pan").set({
direction: Hammer.DIRECTION_ALL
}), d.get("swipe").set({
direction: Hammer.DIRECTION_ALL
}), d.on("panstart", function(b) {
a.$casePanel.removeClass("transition"), e = a.$casePanel[0].offsetTop
}), d.on("panmove", function(b) {
a.swipeTo(e + b.deltaY)
}), d.on("panend", function(b) {
a.$navTop.removeClass("shadow-top"), a.$footer.removeClass("shadow-bottom"), e = a.$casePanel[0].offsetTop
}), d.on("swipe", function(b) {
a.$casePanel.addClass("transition"), a.swipeTo(a.$casePanel[0].offsetTop + 300 * -b.velocityY)
})
}
this.$content.on("mousewheel", function(b) {
b.preventDefault(), a.$casePanel.removeClass("transition"), a.swipeTo(a.$casePanel[0].offsetTop + 50 * b.deltaY, !0)
}), this.$content.on("mousewheel DOMMouseScroll", function(a) {
a.preventDefault()
}), this.$content.on("click", ".book-down", function(b) {
b.preventDefault();
var c = $(this);
return a.downloadBook(c.attr("data-index"), c.attr("data-down"), c), !1
})
}
hf_utils.isLteIE8() ? this.$content.on("click", ".case-list-title", function() {
var d = $(this).attr("data-index"),
e = a.bookObj[d],
f = "" == b.domain || 0 == window.location.href.indexOf(b.baseUrl) ? e.url + "index.html" : "//" + b.domain + "/books/" + e.bLink + "/";
switch("" == b.domain || window.location.href.indexOf(b.baseUrl.replace(/^https?:/, "")) >= 0 ? (f = e.url + "index.html", f = f.replace(/^http:/, location.protocol)) : f = "http://" + b.domain + "/books/" + e.bLink + "/", c) {
case "1":
new DemoPanel(e.title, f);
break;
case "2":
window.open(f, "_blank");
break;
default:
new DemoPanel(e.title, f)
}
}) : new Hammer(this.$content[0]).on("tap", function(d) {
var e = $(d.target),
f = e.parents(".case-list-title");
if(e.hasClass("case-list-title") || f.length > 0) {
e = f.length > 0 ? f : e;
var g = e.attr("data-index"),
h = a.bookObj[g],
i = "" == b.domain || 0 == window.location.href.indexOf(b.baseUrl) ? h.url + "index.html" : "//" + b.domain + "/books/" + h.bLink + "/";
switch("" == b.domain || window.location.href.indexOf(b.baseUrl.replace(/^https?:/, "")) >= 0 ? (i = h.url + "index.html", i = i.replace(/^http:/, location.protocol)) : i = "http://" + b.domain + "/books/" + h.bLink + "/", c) {
case "1":
new DemoPanel(h.title, i);
break;
case "2":
window.open(i, "_blank");
break;
default:
new DemoPanel(h.title, i)
}
}
}), hf_utils.isLteIE8() ? this.$content.on("click", ".case-folder-wrapper", function() {
var b = $(this).attr("data-folder");
a.isShowFolder = !1, a.currentFolderId = b, a.newData = a.folderBooks[b], a.showFolderHideBtns(!1), a.resize()
}) : new Hammer(this.$content[0]).on("tap", function(b) {
var c = $(b.target),
d = c.parents(".case-folder-wrapper");
if(c.hasClass("case-folder-wrapper") || d.length > 0) {
c = d.length > 0 ? d : c;
var e = c.attr("data-folder");
a.isShowFolder = !1, a.currentFolderId = e, a.newData = a.folderBooks[e], a.showFolderHideBtns(!1), a.resize()
}
})
},
createCategory: function() {
var a = this,
b = $("<div class='case-category'></div>"),
c = $("<div class='case-category-content input-form'></div>"),
d = this.options.folderData;
d.unshift({
value: "-1",
label: hf_utils.getLangVal("bcAllBooks"),
isDefault: !0
}), b.append(c).appendTo(this.$casePanel), new SmartSelect({
className: "input-form",
container: c,
data: d,
changeCallback: function(b) {
a.categoryid = b, a.searchFn()
}
})
},
createNav: function() {
var a = this,
b = this.options,
c = this.$navTop,
d = $("<div class='nav-bg'><div class='nav-left'></div><div class='nav-mid'></div><div class='nav-right'></div></div>"),
e = $("<div class='nav-left-content'></div>"),
f = $("<div class='nav-search-content'></div>"),
g = $("<input type='text' class='nav-search-input input-form' />"),
h = $("<div class='nav-search-btn'></div>"),
i = $("<div class='nav-header'></div>"),
j = $("<span class='nav-title'>" + b.title + "</span>"),
k = $("<div class='nav-right-btns'></div>"),
l = $("<div class='nav-sort-btns user-select-none'></div>"),
m = $("<div class='nav-name-sort'></div>"),
n = $("<div class='nav-date-sort'></div>"),
o = $("<div class='nav-share-btn'></div>"),
p = $("<div class='nav-change-btn'></div>").addClass(this.isShowThumb ? "list-show" : ""),
q = function(a, b) {
var c = "asc" == a ? ">" : "<";
return new Function("a", "b", "return a." + b + c + "b." + b + "?1:-1")
},
r = "NewToOld",
s = $("<div class='nav-folder-btn'></div>");
this.$backFolder = s, hf_utils.addPlaceHolder(g, hf_utils.getLangVal("bcSearchText")), g.on("keypress", function(b) {
13 !== b.which || a.isLocked || a.searchFn()
}).on("change input", function() {
a.searchFn()
}), hf_utils.isLteIE8() ? (h.on("click", function() {
a.isLocked || (h.hasClass("cancel-icon") ? a.cancelSearch() : a.searchFn())
}), m.on("click", function() {
a.isLocked || ("AToZ" === r ? (a.newData.sort(q("asc", "title")), r = "ZToA", a.showMessage("Z - A", !0)) : (a.newData.sort(q("desc", "title")), r = "AToZ", a.showMessage("A - Z", !0)), a.resize(!0))
}), n.on("click", function() {
a.isLocked || ("NewToOld" === r ? (a.newData.sort(q("asc", "newTime")), r = "OldToNew", a.showMessage(hf_utils.getLangVal("bcOldUpload") + " - " + hf_utils.getLangVal("bcNewUpload"), !0)) : (a.newData.sort(q("desc", "newTime")), r = "NewToOld", a.showMessage(hf_utils.getLangVal("bcNewUpload") + " - " + hf_utils.getLangVal("bcOldUpload"), !0)), a.resize(!0))
}), o.on("click", function() {
a.isLocked || new SharePanel({
link: b.caseLink,
uLink: b.uLink,
uId: b.uId,
isSelf: b.isSelf
})
}), j.on("click", function() {
a.isLocked || "1" === b.isShowContact && new UserDetailPanel(b)
}), p.on("click", function() {
a.isLocked || a.changeShow()
}), s.on("click", function() {
a.isLocked || (a.isShowFolder = !0, a.newData = a.originalData, a.createListFolder())
})) : (new Hammer(h[0]).on("tap", function() {
a.isLocked || (h.hasClass("cancel-icon") ? a.cancelSearch() : a.searchFn())
}), new Hammer(m[0]).on("tap", function() {
a.isLocked || ("AToZ" === r ? (a.newData.sort(q("asc", "title")), r = "ZToA", a.showMessage("Z - A", !0)) : (a.newData.sort(q("desc", "title")), r = "AToZ", a.showMessage("A - Z", !0)), a.resize(!0))
}), new Hammer(n[0]).on("tap", function() {
a.isLocked || ("NewToOld" === r ? (a.newData.sort(q("asc", "newTime")), r = "OldToNew", a.showMessage(hf_utils.getLangVal("bcOldUpload") + " - " + hf_utils.getLangVal("bcNewUpload"), !0)) : (a.newData.sort(q("desc", "newTime")), r = "NewToOld", a.showMessage(hf_utils.getLangVal("bcNewUpload") + " - " + hf_utils.getLangVal("bcOldUpload"), !0)), a.resize(!0))
}), new Hammer(o[0]).on("tap", function() {
a.isLocked || new SharePanel({
link: b.caseLink,
uLink: b.uLink,
uId: b.uId,
isSelf: b.isSelf
})
}), new Hammer(j[0]).on("tap", function() {
a.isLocked || "1" === b.isShowContact && new UserDetailPanel(b)
}), new Hammer(p[0]).on("tap", function() {
a.isLocked || a.changeShow()
}), new Hammer(s[0]).on("tap", function() {
a.isLocked || (a.isShowFolder = !0, a.newData = a.originalData, a.createListFolder())
})), this.$searchInput = g, this.$searchBtn = h, this.$changeBtn = p, this.$sortBtns = l, "0" != b.isShowSearch && f.append(g).append(h), "0" != b.isShowShare && k.append(o), c.append(d).append(e.append(s).append(f)).append(i.append(j)).append(k.append(l.append(m).append(n)))
},
searchFn: function() {
if(this.isLocked) return void this.$searchInput.val("");
var a = this,
b = this.$searchInput.val().trim().toLowerCase(),
c = this.originalData,
d = [];
b = b == hf_utils.getLangVal("bcSearchText").trim().toLowerCase() ? "" : b, "" == b ? this.$searchBtn.removeClass("cancel-icon") : this.$searchBtn.addClass("cancel-icon");
for(var e = 0; e < c.length; e++) {
var f = c[e],
g = f.title.toLowerCase(),
h = f.description.toLowerCase();
(g && g.match(b) || h && h.match(b)) && ("1" == this.options.isShowCategory ? f.categoryid != this.categoryid && -1 != this.categoryid || d.push(f) : d.push(f))
}
if(this.newData = d, a.isShowFolder = !1, a.showFolderHideBtns(!1), this.resize(), 0 === d.length) {
var i = $("<p>" + hf_utils.getLangVal("bcSearchResult") + "</p>"),
j = $("<a href='javascript:void(0);'>" + hf_utils.getLangVal("bcSearchBack") + "</a>").appendTo(i);
hf_utils.isLteIE8() ? j.on("click", function() {
a.cancelSearch()
}) : new Hammer(j[0]).on("tap", function() {
a.cancelSearch()
}), a.showMessage(i)
} else a.hideMessage()
},
cancelSearch: function() {
this.$searchInput.val("").focus(), this.$searchBtn.removeClass("cancel-icon"), this.hideMessage(), this.searchFn()
},
createFooter: function() {
var a = this.options,
b = a.skin,
c = a.logoName,
d = "" == c ? "" : "//" + a.AS3BucketName + "/" + a.uLink + "/" + c,
e = a.logoLink,
f = "" === e || e.match("http") ? "" == e ? "javascript:void(0);" : e : "//" + e,
g = "" == e ? "" : "target='_blank'";
$logo = $("<a rel='nofollow' class='footer-logo' " + g + " href='" + f + "'></a>"), $img = $("<img src='" + d + "'/>").addClass("" == c ? "hide" : ""), $input = $("<input type='text' class='footer-input input-form' readonly='readonly'/>"), $skinBtn = $("<div class='footer-skin-btn'></div>"), $skin = $("<ul class='footer-skin'><div></div><li class='red'></li><li class='gold'></li><li class='silver'></li><li class='green'></li><li class='yellow'></li></ul>"), oldInput = "", b = "" == b ? "red" : b, $skin.find("li." + b).addClass("active"), hf_utils.isLteIE8() ? ($skinBtn.on("click", function() {
$skinBtn.hasClass("show") ? $skinBtn.removeClass("show") : $skinBtn.addClass("show")
}), $skin.on("click", "li", function(a) {
var b = $(this);
$skin.find("li").removeClass("active"), $("body").removeClass().addClass(b.attr("class")), b.addClass("active")
})) : (new Hammer($skinBtn[0]).on("tap", function() {
$skinBtn.hasClass("show") ? $skinBtn.removeClass("show") : $skinBtn.addClass("show")
}), $skin.find("li").each(function(a, b) {
var c = $(b);
new Hammer(c[0]).on("tap", function() {
$skin.find("li").removeClass("active"), $("body").removeClass().addClass(c.attr("class")), c.addClass("active")
})
})), this.$numInput = $input, "0" != a.isShowLogo && this.$footer.append($logo.append($img)), "0" != a.isShowSkin && this.$footer.append($skinBtn.append($skin)), this.$footer.append($input), this.setNumWidth()
},
setNumInput: function(a) {
var b = this.newData.length,
c = Math.abs(a),
d = Math.floor(Math.abs(c - this.firstOther) / this.rowHeight),
e = c - (d * this.rowHeight + this.firstOther),
f = 0,
g = b;
d = e >= this.rowHeight - 10 ? d + 1 : d, f = d * this.cols, g = f + Math.ceil((this.$content.height() + e - 40) / this.rowHeight) * this.cols - 1, g = Math.min(g, b), this.loadBookFace(f)
},
setNumWidth: function() {
var a = this.originalData.length,
b = a,
c = $("<div></div>").text(b).css({
fontSize: this.$numInput.css("font-size"),
display: this.$numInput.css("display"),
opacity: 0
}).appendTo(this.$numInput.parent()),
d = c.outerWidth() + 20;
d = d < 40 ? 40 : d, c.remove(), this.$numInput.val(a).width(d)
},
swipeByPage: function() {
var a = parseInt(this.$numInput.val().trim(), 10),
b = 1,
c = 0,
d = this.newData.length;
a = (isNaN(a) || a) < 1 ? 1 : a > d ? d : a, b = Math.ceil(a / this.cols), c = (b - 1) * this.rowHeight + this.firstOther, this.swipeTo(-c, !1, !0)
},
createRow: function(a) {
var b = this.newData.length,
c = this.$content.width(),
d = this.$content.height(),
e = Math.max(1, Math.floor((c - 2 * this.offsetX) / this.bookWidth)),
f = Math.ceil(b / e),
g = Math.ceil((d - this.firstOther) / this.rowHeight),
f = Math.max(f, g),
h = e * this.bookWidth,
i = f * this.rowHeight + this.firstOther - d - 6;
this.isShowThumb = !0, this.rows = f, this.cols = e, this.minRows = g, this.maxMove = i, a || this.createBackground(f), this.createBook(f, e, h, b)
},
createBook: function(a, b, c, d) {
var e = this;
e.options;
this.$caseContent.empty();
for(var f = 0; f < a; f++) {
for(var g = "1" == this.options.isShowCategory && 0 == f ? "high-row" : "", h = $("<div class='case-row " + g + "'></div>"), i = $("<div class='case-wrapper'></div").width(c), j = 0; j < b; j++) {
var k = f * b + j;
if(!(k < d)) break;
var l = this.newData[k],
m = l.id,
n = l.title,
o = l.newTime,
p = l.isDownload,
q = l.label.toString();
if(this.cache[m] && this.cache[m].length > 0) {
var r = this.cache[m];
r.attr("data-id", k)
} else {
var r = $("<div class='book-content' data-index='" + m + "' data-id='" + k + "' load-status='none'></div>"),
s = $("<div class='book-wrapper' data-index='" + m + "' data-id='" + k + "' title='" + hf_utils.encodeHTML(n) + "'></div>"),
t = ($("<div class='book-face'></div>"), $("<div class='book-down' title='ä¸‹è½½' data-index='" + m + "' data-down='" + p + "'></div>"), $("<img class='book-img' src=''/>"));
if(r.width(this.bWidth).height(this.bHeight), "0" !== q && s.append("<img class='book-label-img' src='" + hf_utils.getLabelFilePath(q) + "'>"), 1 == e.options.infoShow || 2 == e.options.infoShow) {
var u = 1 == e.options.infoShow ? hf_utils.parseDate(o, !0) : 2 == e.options.infoShow ? n : "";
$("<div class='book-outer-title'><span>" + u + "</span></div>").addClass("mode-" + e.options.bMode).appendTo(s)
}
r.append(s.append(t).append("<div class='loading'><img src='/bookcase/img/loading.gif'></div>")), this.bookObj[m] = l, this.minRows
}
r.appendTo(i)
}
h.append(i).appendTo(this.$caseContent)
}
},
loadBookFace: function(a) {
for(var b = this, c = b.options, d = this.cols * this.minRows + 2, e = 0; e <= d; e++) {
var f = e + a,
g = this.$content.find(".book-content[data-id=" + f + "]");
if(g.length > 0 && "loaded" !== g.attr("load-status")) {
var h = g.find(".book-wrapper"),
i = g.find(".book-img"),
j = g.attr("data-index"),
k = this.bookObj[j];
hf_utils.getBookUrl(k.url, c.uLink, k.bLink, k.bStatus, k.isPublic, c.uType, k.auditStatus, g, h, i, j, b.autoFitToBottom2.bind(b))
}
}
},
createBackground: function(a) {
this.$caseBG.empty();
for(var b = 0; b < a; b++) {
var c = "1" == this.options.isShowCategory && 0 == b ? "high-row" : "";
this.$caseBG.append("<div class='case-row " + c + "'><div class='case-left'></div><div class='case-mid'></div><div class='case-right'></div></div>")
}
},
resize: function(a) {
this.isShowFolder ? this.showFolder() : this.isShowThumb ? this.createRow(a) : this.createList(a), this.swipeTo(0, !1, !0)
},
swipeTo: function(a, b, c) {
var d = this;
a > 0 ? (a = 0, this.$navTop.addClass(c ? "" : "shadow-top"), b && setTimeout(function() {
d.$navTop.removeClass("shadow-top")
}, 200)) : a < -this.maxMove && (a = -this.maxMove, this.$footer.addClass(c ? "" : "shadow-bottom"), b && setTimeout(function() {
d.$footer.removeClass("shadow-bottom")
}, 200)), hf_utils.isMobile() ? this.$content.scrollTop(Math.abs(a)) : this.$casePanel.css("top", a), this.setNumInput(a)
},
autoFitToBottom: function(a, b, c, d) {
var e = this,
f = new Image;
f.onload = function() {
c.fadeIn();
var g, h, i = a.height(),
j = a.width(),
k = f.width / f.height,
l = i,
m = i * k;
m > j && (m = j, l = j / k), g = (j - m) / 2, h = i - l, b.css({
width: m,
height: l,
left: g,
top: h
});
var n, o = 4,
p = $("<div class='book-border-container'></div>");
for(p.css({
right: -(o - 1),
width: o
}), n = 0; n < o; n++) {
$("<div></div>").css({
position: "absolute",
width: 1,
background: n % 2 == 0 ? "#ccc" : "#fff",
height: l - 2 * (n + 1),
top: n + 1,
left: n + 1
}).appendTo(p)
}
c.after(p), setTimeout(function() {
b.fadeIn(400, function() {
e.cache[d] = a, a.attr("load-status", "loaded")
}), a.find(".loading").remove()
}, 50)
}, f.onerror = function() {
var f, g, h = $("<div class='as-book-img'></div>"),
i = a.height(),
j = a.width(),
k = .75,
l = i,
m = i * k;
m > j && (m = j, l = j / k), f = (j - m) / 2, g = i - l, b.css({
width: m,
height: l,
left: f,
top: g
});
var n, o = 4,
p = $("<div class='book-border-container'></div>");
for(p.css({
right: -(o - 1),
width: o
}), n = 0; n < o; n++) {
$("<div></div>").css({
position: "absolute",
width: 1,
background: n % 2 == 0 ? "#ccc" : "#fff",
height: l - 2 * (n + 1),
top: n + 1,
left: n + 1
}).appendTo(p)
}
c.after(h).after(p), setTimeout(function() {
c.hide(), b.fadeIn(400, function() {
e.cache[d] = a
}), a.attr("load-status", "loaded")
}, 50), a.find(".loading").remove()
}, f.src = c.attr("src")
},
autoFitToBottom2: function(a, b, c, d, e) {
var f = this,
g = new Image;
g.onload = function() {
g.onload = g.onerror = null, c.fadeIn();
var e, h, i = a.height(),
j = a.width(),
k = g.width / g.height,
l = i,
m = i * k;
m > j && (m = j, l = j / k), e = (j - m) / 2, h = i - l, b.css({
width: m,
height: l,
left: e,
top: h
});
var n, o = 4,
p = $("<div class='book-border-container'></div>");
for(p.css({
right: -(o - 1),
width: o
}), n = 0; n < o; n++) {
$("<div></div>").css({
position: "absolute",
width: 1,
background: n % 2 == 0 ? "#ccc" : "#fff",
height: l - 2 * (n + 1),
top: n + 1,
left: n + 1
}).appendTo(p)
}
c.after(p), setTimeout(function() {
b.fadeIn(400, function() {
f.cache[d] = a, a.attr("load-status", "loaded")
}), a.find(".loading").remove()
}, 50)
}, g.onerror = function() {
g.onload = g.onerror = null;
var h = new Image;
h.onload = function() {
h.onload = h.onerror = null, c.fadeIn();
var e, g, i = a.height(),
j = a.width(),
k = h.width / h.height,
l = i,
m = i * k;
m > j && (m = j, l = j / k), e = (j - m) / 2, g = i - l, b.css({
width: m,
height: l,
left: e,
top: g
});
var n, o = 4,
p = $("<div class='book-border-container'></div>");
for(p.css({
right: -(o - 1),
width: o
}), n = 0; n < o; n++) {
$("<div></div>").css({
position: "absolute",
width: 1,
background: n % 2 == 0 ? "#ccc" : "#fff",
height: l - 2 * (n + 1),
top: n + 1,
left: n + 1
}).appendTo(p)
}
c.after(p), setTimeout(function() {
b.fadeIn(400, function() {
f.cache[d] = a, a.attr("load-status", "loaded")
}), a.find(".loading").remove()
}, 50)
}, h.onerror = function() {
h.onload = h.onerror = null;
var e, g, i = $("<div class='as-book-img'></div>"),
j = a.height(),
k = a.width(),
l = .75,
m = j,
n = j * l;
n > k && (n = k, m = k / l), e = (k - n) / 2, g = j - m, b.css({
width: n,
height: m,
left: e,
top: g
});
var o, p = 4,
q = $("<div class='book-border-container'></div>");
for(q.css({
right: -(p - 1),
width: p
}), o = 0; o < p; o++) {
$("<div></div>").css({
position: "absolute",
width: 1,
background: o % 2 == 0 ? "#ccc" : "#fff",
height: m - 2 * (o + 1),
top: o + 1,
left: o + 1
}).appendTo(q)
}
c.after(i).after(q), setTimeout(function() {
c.hide(), b.fadeIn(400, function() {
f.cache[d] = a
}), a.attr("load-status", "loaded")
}, 50), a.find(".loading").remove()
}, h.src = e + "files/shot.png"
}, g.src = e + "1.webp"
},
shakeMessage: function() {
this.$caseMess.animate({
left: "-=2px"
}, 50).animate({
left: "+=4px"
}, 50).animate({
left: "-=4px"
}, 50).animate({
left: "+=2px"
}, 50)
},
showMessage: function(a, b) {
this.$messPanel.html(a), this.$caseMess.stop(!0, !0).fadeIn(), b && this.$caseMess.stop(!0, !0).delay(1e3).fadeOut()
},
hideMessage: function() {
this.$caseMess.hide()
},
hasEncrypt: function() {
function a() {
var a = e.val().trim();
if(e.removeClass("invalid"), !f.hasClass("disabled")) return "" === a ? (e.addClass("invalid"), void b.shakeMessage()) : void $.ajax({
url: hf_utils.requestDomain() + "/center/db/check-bookcase-pass-online.php",
type: "get",
dataType: "jsonp",
data: {
linkName: b.options.bookcaseLink,
pass: a,
isFolderList: b.options.isFolderList
},
beforeSend: function() {
f.html(hf_utils.getLangVal("bcEncryptRefer")).addClass("disabled")
},
success: function(a) {
1 == a.status ? (b.isLocked = !1, b.originalData = a.books, b.newData = a.books, b.options.folderData = a.catesArr, "1" == b.options.isShowCategory && b.createCategory(), b.resize(!1), b.hideMessage(), b.setNumWidth()) : (d.html(hf_utils.getLangVal("bcEncryptError")), e.addClass("invalid"), f.html(hf_utils.getLangVal("bcEncryptBtn")).removeClass("disabled"), b.shakeMessage())
},
error: function() {
d.html(hf_utils.getLangVal("bcEncryptError2")), e.addClass("invalid"), f.html(hf_utils.getLangVal("bcEncryptBtn")).removeClass("disabled"), b.shakeMessage()
}
})
}
var b = this,
c = $("<div class='encrypt-content'></div>"),
d = $("<p>" + hf_utils.getLangVal("bcEncryptText") + "</p>"),
e = $("<input placeholder='" + hf_utils.getLangVal("bcEncryptInput") + "' type='password'/>"),
f = $("<div class='button button-gray'>" + hf_utils.getLangVal("bcEncryptBtn") + "</div>");
return e.on("keypress", function(b) {
13 === b.which && a()
}), hf_utils.isLteIE8() ? f.on("click", function() {
a()
}) : new Hammer(f[0]).on("tap", function() {
a()
}), c.append(d).append(e).append(f), c
},
downloadBook: function(a, b, c) {
if(b && "" != b && "0" != b) {
var d = b.split(","),
e = d.indexOf("1") >= 0,
f = d.indexOf("2") >= 0,
g = d.indexOf("3") >= 0,
h = d.indexOf("4") >= 0,
i = d.indexOf("5") >= 0;
if(d.length > 1) new BookDownload({
bookId: a,
len: d.length,
downObj: {
pdf: e,
zip: f,
exe: g,
exe2: h,
mac: i
}
});
else if(0 != d.length) switch(d[0].toString()) {
case "1":
hf_utils.downPDF(a);
break;
case "2":
hf_utils.downZIP(c, a);
break;
case "3":
hf_utils.downEXE1(c, a);
break;
case "4":
hf_utils.downEXE2(c, a);
break;
case "5":
hf_utils.downMAC(c, a)
}
}
},
changeShow: function() {
this.isShowThumb ? (this.$changeBtn.removeClass("list-show"), this.createList()) : (this.$changeBtn.addClass("list-show"), this.createRow()), this.swipeTo(0, !1, !0)
},
createList: function(a) {
var b = 400,
c = 43,
d = 36,
e = "1" == this.options.isShowCategory ? 70 : 40,
f = 40,
g = this.newData.length,
h = this.$content.width(),
i = this.$content.height(),
j = Math.max(1, Math.floor((h - 2 * d) / b)),
k = Math.ceil(g / j),
l = Math.max(i, k * c + e + f);
maxMove = Math.max(0, k * c + e + f - i - 6), this.isShowThumb = !1, this.maxMove = maxMove, this.createListBG(l), this.createListBook(j, h - 2 * d, g)
},
createListContent: function(a, b) {
for(var c = Math.floor(a / b), d = a - c * b, e = [], f = $("<div class='case-list-content'></div>").addClass("1" == this.options.isShowCategory ? "other-margin" : ""), g = 0, h = 0; h < b; h++) {
var i = h < d ? c + 1 : c,
j = $("<div class='case-list-col'></div>").css("left", g).width(i),
k = $("<div class='case-list-col-inner'></div>");
g += i, e[h] = k, j.append(k).appendTo(f)
}
return f.appendTo(this.$caseContent), e
},
createListBG: function(a) {
this.$caseBG.empty();
var b = $("<div class='case-list-upper-bg'><div class='case-list-upper-left'></div><div class='case-list-upper-mid'></div><div class='case-list-upper-right'></div></div>"),
c = $("<div class='case-list-mid-bg'><div class='case-list-center-left'></div><div class='case-list-center-mid'></div><div class='case-list-center-right'></div></div>"),
d = $("<div class='case-list-down-bg'><div class='case-list-down-left'></div><div class='case-list-down-mid'></div><div class='case-list-down-right'></div></div>"),
e = $("<div class='case-list-bg'></div>").height(a);
this.$caseBG.append(e.append(b).append(c).append(d))
},
createListBook: function(a, b, c) {
this.$caseContent.empty();
for(var d = this, e = this.createListContent(b, a), f = 0; f < c; f++) {
var g = this.newData[f],
h = g.id,
i = g.title,
j = (g.isDownload, g.label.toString(), $("<div class='case-list-down'></div>"), $("<span class='case-list-index'>" + (f + 1) + ".</span>"), $("<span class='case-list-title' data-index='" + h + "'>" + i + "</span>")),
k = $("<div class='case-list-item' data-index='" + h + "'></div>");
d.bookObj[h] = g, k.append(j).appendTo(e[f % a])
}
e.forEach(function(a) {
$(a).stop(!1, !0).show()
})
},
showFolder: function() {
var a = 144,
b = 151,
c = this.options.folderData;
folderNum = c.length, midWidth = this.$content.width(), midHeight = this.$content.height(), paddingTop = 20, paddingBottom = 20, paddingWidth = 20, cols = Math.max(1, Math.floor((midWidth - 2 * paddingWidth) / a)), rows = Math.ceil(folderNum / cols), bgHeight = Math.max(midHeight, rows * b + paddingTop + paddingBottom), warpWidth = cols * a, maxMove = Math.max(0, rows * b + paddingTop + paddingBottom - midHeight - 6), warpWidth = warpWidth + 2 * paddingWidth > midWidth ? Math.max(midWidth - 2 * paddingWidth, 128) : warpWidth, this.maxMove = maxMove, this.createFolderBG(bgHeight), this.createFolder(warpWidth, folderNum)
},
createFolder: function(a, b) {
var c = this,
d = c.options,
e = d.folderData;
this.$caseContent.empty();
for(var f = $("<div class='case-folder-content'></div").width(a), g = 0; g < e.length; g++) {
var h = e[g],
i = h.value,
j = h.books;
this.folderBooks[i] = j;
var k = $("<div class='case-folder-item'></div>"),
l = $("<div class='case-folder-wrapper' data-folder='" + i + "'></div>"),
m = $("<div class='case-folder-info'></div>"),
n = $("<div class='case-folder-title'>" + h.label + "</div>"),
o = j.length,
p = o + (o > 1 ? hf_utils.getLangVal("bcBookUnits") : hf_utils.getLangVal("bcBookUnit"));
$folderBooks = $("<div class='case-folder-num'>ï¼ˆ" + p + "ï¼‰</div>"), k.append(l.append(m.append(n).append($folderBooks))).appendTo(f)
}
this.$caseContent.append(f)
},
createFolderBG: function(a) {
this.$caseBG.empty();
var b = $("<div class='case-list-upper-bg'><div class='case-list-upper-left'></div><div class='case-list-upper-mid'></div><div class='case-list-upper-right'></div></div>"),
c = $("<div class='case-list-mid-bg'><div class='case-list-center-left'></div><div class='case-list-center-mid'></div><div class='case-list-center-right'></div></div>"),
d = $("<div class='case-list-down-bg'><div class='case-list-down-left'></div><div class='case-list-down-mid'></div><div class='case-list-down-right'></div></div>"),
e = $("<div class='case-list-bg'></div>").height(a);
this.$caseBG.append(e.append(b).append(c).append(d))
},
showFolderHideBtns: function(a, b) {
var c = this;
if(!c.isFolderList) return void c.$backFolder.hide();
a ? (hf_utils.addPlaceHolder(c.$searchInput, hf_utils.getLangVal("bcSearchText")), c.$searchBtn.removeClass("cancel-icon"), !b && c.hideMessage(), c.$changeBtn.removeClass("show").addClass("hide"), c.$sortBtns.removeClass("show").addClass("hide"), c.$numInput.val(c.options.folderData.length), c.currentFolderId = "-1") : (c.$changeBtn.removeClass("hide").addClass("show"), c.$sortBtns.removeClass("hide").addClass("show"), c.$numInput.val(c.newData.length))
},
createListFolder: function() {
for(var a = this, b = $("<div class='folder-list-panel'></div>"), c = $("<div class='folder-list-bg'></div>"), d = $("<div class='folder-list-outter-box'></div>"), e = $("<div class='folder-list-arrow'></div>"), f = $("<div class='folder-list-box'></div>"), g = $("<div class='folder-list-up'>" + hf_utils.getLangVal("bcFolderList") + "</div>"), h = $("<div class='folder-list-colse'></div>"), i = $("<div class='folder-list-down'></div>"), j = $("<ul class='folder-list-ul'></ul>"), k = $("<div class='folder-list-back'></div>"), l = $("<div class='folder-list-back-btn'><span></span>" + hf_utils.getLangVal("bcBackFolder") + "</div>"), m = this.options.folderData, n = 0; n < m.length; n++) {
var o = m[n],
p = o.value,
q = o.books,
r = q.length,
s = $("<li class='folder-list-item' data-index='" + p + "'><span class='folder-list-item-text' data-index='" + p + "'>" + o.label + "</span><span class='book-num'>ï¼ˆ" + r + "ï¼‰</span></li>");
j.append(s)
}
var t = !0,
u = function() {
c.fadeOut(100), f.animate({
opacity: 0
}, 200, function() {
b.remove()
}), e.animate({
opacity: 0
}, 200)
},
v = function(b) {
a.isShowFolder = "-1" == b, a.currentFolderId = b, a.newData = "-1" == b ? a.originalData : a.folderBooks[b], a.showFolderHideBtns(a.isShowFolder), a.resize(), u(), t = !1
};
hf_utils.isLteIE8() ? (j.on("click", ".folder-list-item", function() {
if(t) {
var a = $(this).attr("data-index");
v(a), t = !1
}
}), l.on("click", function() {
v("-1")
}), h.on("click", function() {
u()
}), c.add(d).on("click", function() {
u()
}), f.add(e).on("click", function(a) {
return a.preventDefault(), a.stopPropagation(), !1
})) : (new Hammer(j[0]).on("tap", function(a) {
if(t) {
var b = $(a.target),
c = b.parents(".folder-list-item");
if(b.hasClass("folder-list-item") || c.length > 0) {
b = c.length > 0 ? c : b;
var d = b.attr("data-index");
v(d), t = !1
}
}
}), new Hammer(l[0]).on("tap", function(a) {
v("-1")
}), new Hammer(h[0]).on("tap", function(a) {
u()
}), new Hammer(c[0]).on("tap", function(a) {
u()
}), new Hammer(d[0]).on("tap", function(a) {
u()
}), new Hammer(f[0]).on("tap", function(a) {
return a.preventDefault(), a.stopPropagation(), !1
}), new Hammer(e[0]).on("tap", function(a) {
return a.preventDefault(), !1
})), b.append(c).append(d.append(e).append(f.append(g.append(h)).append(i.append(j)).append(k.append(l)))).appendTo(this.$container), b.show(), c.fadeIn(100), f.animate({
opacity: 1
}, 100), e.animate({
opacity: 1
}, 100)
}
}, LightBox.prototype = {
constructor: LightBox,
getBox: function() {
return this.$box
},
getPanel: function() {
return this.$panel
},
getCancelBtn: function() {
return this.$cancelBtn
},
launch: function(a) {
var b = $("body"),
c = this;
b.addClass("b-hidden"), this.$outBox.appendTo(b), setTimeout(function() {
c.$outBox.addClass("fade-in")
}, 5), this.resize(0)
},
cancel: function() {
var a = this;
a.$outBox.addClass("fade-out").removeClass("fade-in"), setTimeout(function() {
document.getElementsByClassName("light-box-out").length <= 1 && $("body").removeClass("b-hidden"), a.$outBox.remove()
}, 350)
},
setStopResize: function(a) {
this.stopResize = a
},
getStopResize: function() {
return this.stopResize
},
resize: function(a) {
if(!this.getStopResize()) {
var b = (window.innerWidth || $(window).width()) < this.width ? "100%" : this.width;
this.$content.width(b)
}
}
}, SmartSelect.prototype = {
constructor: SmartSelect,
val: function() {
return this.$val.data("value")
},
choose: function(a) {
var b = this.options.changeCallback;
$target = $(a.target), $target.is("li") && (this.$val.text($target.data("label")).data("value", $target.data("value")), b && b($target.data("value")))
},
toggleOption: function() {
this.showing ? this.hideOptions() : this.showOptions()
},
showOptions: function() {
var a = this;
a.$opt.stop().show().animate({
marginTop: 0,
opacity: 1
}, 200, function() {
a.showing = !0
})
},
hideOptions: function() {
var a = this;
a.$opt.stop().animate({
marginTop: -3,
opacity: 0
}, 100, function() {
a.showing = !1, a.$opt.hide()
})
}
}, UserDetailPanel.prototype = {
sendAnother: function() {
this.lightBox.cancel(), new UserDetailPanel(this.opt)
},
close: function() {
this.lightBox.cancel()
},
reSend: function() {
this.$errorGroup.slideUp(), this.$sendingGroup.slideDown(), this.send()
},
send: function() {
var a = this,
b = this.$nameInput.val().trim(),
c = this.$emailInput.val().trim(),
d = this.$subjectInput.val().trim(),
e = this.$messageArea.val().trim(),
f = (this.opt.name, this.opt.email, this.opt.bookcaseLink);
hf_utils.validateForm(this.$contactForm) && $.ajax({
type: "post",
url: hf_utils.requestDomain + "/Email/bookcase.email.php",
data: {
fromFullName: b,
fromEmail: c,
fromSubject: d,
fromMessage: e,
bookcaseLink: f,
Code: hex_md5(encodeURIComponent(b + c + d + e + f + "anyflip"))
},
beforeSend: function() {
a.$contactForm.slideUp(), a.$sendingGroup.slideDown()
},
success: function(b) {
a.$sendingGroup.slideUp(), "1" == b ? a.$successGroup.slideDown() : a.$errorGroup.slideDown()
},
error: function() {
a.$sendingGroup.slideUp(), a.$errorGroup.slideDown()
}
})
}
}, ToolTip.prototype = {
constructor: ToolTip,
getPanel: function() {
return this.$panel
},
create: function() {
var a = $("<div class='tool-tip-panel'></div>").addClass(this.options.position),
b = $("<div class='tool-tip-arrow'></div>").addClass(this.options.isBig ? "big" : ""),
c = $("<div class='tool-tip-text'></div>").html(this.options.text);
return a.append(b).append(c), this.$panel = a, a
},
setPosition: function() {
var a = this.options.container,
b = a.offset(),
c = b.top,
d = b.left,
e = (a.outerWidth(), a.outerHeight(), this.options.content),
f = e.offset(),
g = f.top,
h = f.left,
i = e.outerWidth(),
j = e.outerHeight(),
k = this.$panel,
l = k.outerWidth(),
m = k.outerHeight(),
n = 0,
o = 0,
p = this.options.isBig ? 16 : this.options.otherLeft,
q = this.options.isBig ? 16 : this.options.otherTop;
switch(this.options.position.toLowerCase()) {
case "top":
n = h - d - (l - i) / 2, o = g - c - (m + q);
break;
case "left":
n = h - d - (l + p), o = g - c - (m - j) / 2;
break;
case "right":
n = h - d + (i + p), o = g - c - (m - j) / 2
}
k.css({
left: n,
top: o
})
},
destroy: function() {
var a = this;
a.$panel.fadeOut(function() {
a.$panel.remove()
})
}
};